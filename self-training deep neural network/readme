code for self-training DNN
